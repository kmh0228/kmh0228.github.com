<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
	</body>
</html>
<script type="text/javascript">
	var writeln = function(str){
		var wstr = '';
		if(str.toString() == '[object Object]'){
			
			for(var name in str){
				wstr += name + ' : ' + str[name] + '</br>';
			}
			
		}else{
			wstr = str + '</br>';
		}
		document.body.innerHTML += wstr + '-----------------</br>';
	};
	
	var j = 'jquery';
	var k = window;
	var l = document;
	
	writeln(k.FileReader);
	console.log(k.JSZip);
	
	//m=jquery.fn.dateTabel;
	//m.ext.buttons.excelHtml5 = excelHtml5opts;
	 var excelHtml5opts= {
		className: "buttons-excel buttons-html5",
		available: function() {
			return k.FileReader !== q && (t || k.JSZip) !== q && !H() && w
		},
		text: function(a) {
			return a.i18n("buttons.excel", "Excel")
		},
		action: function(a, c, d, b) {
			this.processing(!0);
			var e = this,
				f = 0,
				a = function(a) {
					return j.parseXML(z[a])
				},
				g = a("xl/worksheets/sheet1.xml"),
				n = g.getElementsByTagName("sheetData")[0],
				a = {
					_rels: {
						".rels": a("_rels/.rels")
					},
					xl: {
						_rels: {
							"workbook.xml.rels": a("xl/_rels/workbook.xml.rels")
						},
						"workbook.xml": a("xl/workbook.xml"),
						"styles.xml": a("xl/styles.xml"),
						worksheets: {
							"sheet1.xml": g
						}
					},
					"[Content_Types].xml": a("[Content_Types].xml")
				},
				d = c.buttons.exportData(b.exportOptions),
				h, l, i = function(a) {
					h = f + 1;
					l = p(g, "row", {
						attr: {
							r: h
						}
					});
					for (var b = 0, c = a.length; b < c; b++) {
						var d = x(b) + "" + h,
							e = null;
						if (!(null === a[b] || a[b] === q || "" === a[b])) {
							a[b] = j.trim(a[b]);
							for (var i = 0, k = I.length; i < k; i++) {
								var m = I[i];
								if (a[b].match && !a[b].match(/^0\d+/) && a[b].match(m.match)) {
									e = a[b].replace(/[^\d\.\-]/g, "");
									m.fmt && (e = m.fmt(e));
									e = p(g, "c", {
										attr: {
											r: d,
											s: m.style
										},
										children: [p(g, "v", {
											text: e
										})]
									});
									break
								}
							}
							e || ("number" === typeof a[b] || a[b].match && a[b].match(/^-?\d+(\.\d+)?$/) && !a[b].match(/^0\d+/) ? e = p(g, "c", {
								attr: {
									t: "n",
									r: d
								},
								children: [p(g, "v", {
									text: a[b]
								})]
							}) : (m = !a[b].replace ? a[b] : a[b].replace(/[\x00-\x09\x0B\x0C\x0E-\x1F\x7F-\x9F]/g, ""), e = p(g, "c", {
								attr: {
									t: "inlineStr",
									r: d
								},
								children: {
									row: p(g, "is", {
										children: {
											row: p(g, "t", {
												text: m
											})
										}
									})
								}
							})));
							l.appendChild(e)
						}
					}
					n.appendChild(l);
					f++
				};
			j("sheets sheet", a.xl["workbook.xml"]).attr("name", N(b));
			b.customizeData && b.customizeData(d);
			var m = function(a, b) {
					var c = j("mergeCells", g);
					c[0].appendChild(p(g, "mergeCell", {
						attr: {
							ref: "A" + a + ":" + x(b) + a
						}
					}));
					c.attr("count", c.attr("count") + 1);
					j("row:eq(" + (a - 1) + ") c", g).attr("s", "51")
				},
				o = c.buttons.exportInfo(b);
			o.title && (i([o.title], f), m(f, d.header.length - 1));
			o.messageTop && (i([o.messageTop], f), m(f, d.header.length - 1));
			b.header && (i(d.header, f), j("row:last c", g).attr("s", "2"));
			for (var c = 0, s = d.body.length; c < s; c++) i(d.body[c], f);
			b.footer && d.footer && (i(d.footer, f), j("row:last c", g).attr("s", "2"));
			o.messageBottom && (i([o.messageBottom], f), m(f, d.header.length - 1));
			c = p(g, "cols");
			j("worksheet", g).prepend(c);
			i = 0;
			for (m = d.header.length; i < m; i++) c.appendChild(p(g, "col", {
				attr: {
					min: i + 1,
					max: i + 1,
					width: J(d, i),
					customWidth: 1
				}
			}));
			b.customize && b.customize(a);
			b = new(t || k.JSZip);
			d = {
				type: "blob",
				mimeType: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
			};
			y(b, a);
			b.generateAsync ? b.generateAsync(d).then(function(a) {
				r(a, o.filename);
				e.processing(false)
			}) : (r(b.generate(d), o.filename), this.processing(!1))
		},
		filename: "*",
		extension: ".xlsx",
		exportOptions: {},
		header: !0,
		footer: !1,
		title: "*",
		messageTop: "*",
		messageBottom: "*"
	};

	
</script>